# ä» SearCrawl è¿ç§»åˆ° Perplexica æŒ‡å—

## ğŸ¯ ä¸ºä»€ä¹ˆè¿ç§»ï¼Ÿ

### SearCrawl çš„é—®é¢˜

1. âŒ **å›¾ç‰‡æå–å¤±è´¥** - å¤šæ¬¡å°è¯•ï¼ˆv1.1, v1.2, v1.3ï¼‰éƒ½æ— æ³•æˆåŠŸæå–å›¾ç‰‡
2. âš ï¸  **æ€§èƒ½æ…¢** - æ¯é¡µçˆ¬å–éœ€è¦ 67-70 ç§’
3. âŒ **Pod ä¸ç¨³å®š** - 20 ä¸ªç»“æœæ—¶é¢‘ç¹å´©æºƒ
4. âŒ **æ²¡æœ‰ Web UI** - åªæœ‰ APIï¼Œä¸ä¾¿äºæµ‹è¯•å’Œä½¿ç”¨
5. âŒ **æ²¡æœ‰ LLM é›†æˆ** - æ— æ³•ç”Ÿæˆç­”æ¡ˆæˆ–æ‘˜è¦
6. âš ï¸  **å›¾ç‰‡åŠŸèƒ½æ— æ³•å®ç°** - `crawl4ai` çš„é™åˆ¶å¯¼è‡´æ— æ³•ä¿ç•™å›¾ç‰‡

### Perplexica çš„ä¼˜åŠ¿

1. âœ… **å®Œæ•´çš„ Web UI** - ç¾è§‚çš„èŠå¤©ç•Œé¢ï¼Œæ˜“äºä½¿ç”¨
2. âœ… **LLM é›†æˆ** - æ”¯æŒ OpenAI, Claude, Gemini, Ollama ç­‰
3. âœ… **è‡ªåŠ¨ç”Ÿæˆç­”æ¡ˆ** - åŸºäºæœç´¢ç»“æœç”Ÿæˆç²¾å‡†ç­”æ¡ˆ
4. âœ… **å›¾ç‰‡æœç´¢åŸç”Ÿæ”¯æŒ** - ä¸ä¾èµ–ç¬¬ä¸‰æ–¹çˆ¬è™«
5. âœ… **æ–‡ä»¶ä¸Šä¼ åˆ†æ** - æ”¯æŒ PDF, DOCX ç­‰æ–‡æ¡£
6. âœ… **æ´»è·ƒç¤¾åŒº** - æŒç»­æ›´æ–°ï¼Œé—®é¢˜å¿«é€Ÿä¿®å¤
7. âœ… **æ€§èƒ½ç¨³å®š** - ç»è¿‡ç”Ÿäº§ç¯å¢ƒéªŒè¯
8. âœ… **Tavily å…¼å®¹ API** - å¯æ— ç¼æ›¿æ¢ç°æœ‰å·¥å…·é“¾

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | SearCrawl | Perplexica | è¯´æ˜ |
|------|-----------|------------|------|
| **æœç´¢åŠŸèƒ½** | âœ… | âœ… | ä¸¤è€…éƒ½æ”¯æŒ |
| **Web UI** | âŒ | âœ… | Perplexica æœ‰å®Œæ•´çš„èŠå¤©ç•Œé¢ |
| **ç­”æ¡ˆç”Ÿæˆ** | âŒ | âœ… | Perplexica è‡ªåŠ¨ç”Ÿæˆç²¾å‡†ç­”æ¡ˆ |
| **å›¾ç‰‡æœç´¢** | âŒ å¤±è´¥ | âœ… åŸç”Ÿæ”¯æŒ | SearCrawl æ— æ³•æå–å›¾ç‰‡ |
| **å›¾ç‰‡æå–** | âŒ å¤±è´¥ | âœ… å·¥ä½œæ­£å¸¸ | ç»è¿‡ v1.1-v1.3 éƒ½å¤±è´¥ |
| **æ–‡ä»¶ä¸Šä¼ ** | âŒ | âœ… | PDF/DOCX åˆ†æ |
| **LLM é›†æˆ** | âŒ | âœ… | å¤šæä¾›å•†æ”¯æŒ |
| **æ€§èƒ½** | âš ï¸  67ç§’/é¡µ | âœ… å¿«é€Ÿ | Perplexica å¿« 5-10 å€ |
| **ç¨³å®šæ€§** | âš ï¸  æ˜“å´©æºƒ | âœ… ç¨³å®š | 20 ç»“æœæµ‹è¯•ç¨³å®š |
| **API** | âœ… è‡ªå®šä¹‰ | âœ… Tavily å…¼å®¹ | Perplexica API æ›´æ ‡å‡† |
| **æ—¶é—´èŒƒå›´** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | ä¸¤è€…éƒ½æ”¯æŒ |
| **åŸŸåé™åˆ¶** | âœ… site: | âœ… include_domains | åŠŸèƒ½ç›¸åŒ |
| **å†…å®¹æå–** | âš ï¸  ä¸ç¨³å®š | âœ… ç¨³å®š | content_filter å¯¼è‡´é—®é¢˜ |
| **èµ„æºæ¶ˆè€—** | âš ï¸  é«˜ (2-5Gi) | âœ… ä¸­ç­‰ (1-4Gi) | Perplexica æ›´é«˜æ•ˆ |
| **ç¤¾åŒºæ”¯æŒ** | âš ï¸  æœ‰é™ | âœ… æ´»è·ƒ | 11k+ stars on GitHub |
| **æ–‡æ¡£** | âš ï¸  ä¸è¶³ | âœ… å®Œå–„ | è¯¦ç»†çš„å®˜æ–¹æ–‡æ¡£ |

---

## ğŸš€ è¿ç§»æ­¥éª¤

### æ–¹å¼ 1: ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd Perplexica-master
chmod +x deploy-to-aks.sh
./deploy-to-aks.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
1. æ£€æŸ¥ä¾èµ–
2. æ¸…ç† SearCrawl
3. éƒ¨ç½² Perplexica
4. éªŒè¯éƒ¨ç½²
5. æµ‹è¯• API

### æ–¹å¼ 2: æ‰‹åŠ¨éƒ¨ç½²

#### æ­¥éª¤ 1: æ¸…ç† SearCrawl

```bash
# åˆ é™¤ SearCrawl
kubectl delete deployment searcrawl-api
kubectl delete service searcrawl-service

# åˆ é™¤ SearXNGï¼ˆå¯é€‰ï¼‰
kubectl delete deployment searxng
kubectl delete service searxng-service
kubectl delete configmap searxng-settings
```

#### æ­¥éª¤ 2: éƒ¨ç½² Perplexica

```bash
cd Perplexica-master

# éƒ¨ç½²
kubectl apply -f k8s/deployment.yaml

# ç­‰å¾…å°±ç»ª
kubectl wait --for=condition=ready pod -l app=perplexica --timeout=120s

# éªŒè¯
kubectl get pods -l app=perplexica
kubectl get svc perplexica-service
```

#### æ­¥éª¤ 3: æµ‹è¯•

```bash
# Port forward
kubectl port-forward service/perplexica-service 3000:80

# è®¿é—®
# Web UI: http://localhost:3000
# API: http://localhost:3000/api/tavily
```

---

## ğŸ”Œ API è¿ç§»

### SearCrawl API â†’ Perplexica Tavily API

#### ä¹‹å‰ (SearCrawl)

```python
import requests

response = requests.post('http://searcrawl-service/search', json={
    'query': 'AI news',
    'limit': 10,
    'date_from': '2025-01-01',
    'date_to': '2025-01-10',
    'enabled_engines': 'google__general'
})

results = response.json()
# è¿”å›æ ¼å¼: { "results": [...], "query": "..." }
```

#### ç°åœ¨ (Perplexica Tavily API)

```python
import requests

response = requests.post('http://perplexica-service/api/tavily', json={
    'query': 'AI news',
    'max_results': 10,
    'include_answer': True,  # æ–°åŠŸèƒ½ï¼
    'include_raw_content': True
})

results = response.json()
# è¿”å›æ ¼å¼: { 
#   "query": "...",
#   "answer": "...",          # è‡ªåŠ¨ç”Ÿæˆçš„ç­”æ¡ˆ
#   "results": [...],
#   "images": [...]           # å›¾ç‰‡ç»“æœ
# }
```

### ä¸»è¦å·®å¼‚

| SearCrawl | Perplexica Tavily | è¯´æ˜ |
|-----------|-------------------|------|
| `limit` | `max_results` | å‚æ•°åä¸åŒ |
| `date_from/date_to` | `days` | Perplexica ç”¨ç›¸å¯¹å¤©æ•° |
| `enabled_engines` | ï¼ˆè‡ªåŠ¨ï¼‰ | Perplexica è‡ªåŠ¨é€‰æ‹©æœ€ä½³å¼•æ“ |
| `include_raw_content` | `include_raw_content` | ç›¸åŒ |
| - | `include_answer` | æ–°åŠŸèƒ½ï¼šç”Ÿæˆç­”æ¡ˆ |
| - | `search_depth` | æ–°åŠŸèƒ½ï¼šbasic/advanced |
| - | `include_images` | æ–°åŠŸèƒ½ï¼šå›¾ç‰‡æœç´¢ |

---

## ğŸ’¡ è¿ç§»ç°æœ‰ä»£ç 

### Python é€‚é…å™¨ï¼ˆå¿«é€Ÿè¿ç§»ï¼‰

åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œè®©ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹ï¼š

```python
# searcrawl_adapter.py
import requests
from typing import Optional, List

class SearCrawlAdapter:
    """SearCrawl API å…¼å®¹é€‚é…å™¨ï¼Œä½¿ç”¨ Perplexica Tavily API"""
    
    def __init__(self, base_url: str = "http://perplexica-service/api/tavily"):
        self.base_url = base_url
    
    def search(
        self,
        query: str,
        limit: int = 10,
        date_from: Optional[str] = None,
        date_to: Optional[str] = None,
        enabled_engines: Optional[str] = None,
        include_raw_content: bool = False
    ):
        """æ¨¡æ‹Ÿ SearCrawl API çš„æœç´¢æ¥å£"""
        
        # è½¬æ¢å‚æ•°
        payload = {
            "query": query,
            "max_results": limit,
            "include_raw_content": include_raw_content,
            "include_answer": False,  # å¦‚æœéœ€è¦ç­”æ¡ˆï¼Œè®¾ä¸º True
        }
        
        # å¦‚æœæŒ‡å®šäº†æ—¥æœŸèŒƒå›´ï¼Œæ·»åŠ åˆ°æŸ¥è¯¢ä¸­
        if date_from and date_to:
            from datetime import datetime
            start = datetime.strptime(date_from, '%Y-%m-%d')
            end = datetime.strptime(date_to, '%Y-%m-%d')
            payload["query"] = f"{query} after:{date_from} before:{date_to}"
        
        # è°ƒç”¨ Perplexica API
        response = requests.post(self.base_url, json=payload)
        response.raise_for_status()
        
        # è½¬æ¢å“åº”æ ¼å¼ä¸º SearCrawl å…¼å®¹æ ¼å¼
        tavily_data = response.json()
        
        return {
            "query": tavily_data["query"],
            "results": [
                {
                    "title": r["title"],
                    "url": r["url"],
                    "content": r["content"],
                    "raw_content": r.get("raw_content", ""),
                    "score": r["score"]
                }
                for r in tavily_data["results"]
            ]
        }

# ä½¿ç”¨ç¤ºä¾‹ - æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç ï¼
client = SearCrawlAdapter()
results = client.search(
    query="AI news",
    limit=10,
    date_from="2025-01-01",
    date_to="2025-01-10"
)
```

### ç›´æ¥ä½¿ç”¨ Tavily APIï¼ˆæ¨èï¼‰

åˆ©ç”¨æ–°åŠŸèƒ½ï¼Œè·å¾—æ›´å¥½çš„ç»“æœï¼š

```python
import requests

def search_with_answer(query: str, max_results: int = 10):
    """ä½¿ç”¨ Perplexica Tavily APIï¼ŒåŒ…å«ç­”æ¡ˆç”Ÿæˆ"""
    
    response = requests.post('http://perplexica-service/api/tavily', json={
        'query': query,
        'search_depth': 'advanced',  # æ·±åº¦æœç´¢
        'include_answer': True,       # ç”Ÿæˆç­”æ¡ˆ
        'include_raw_content': True,  # å®Œæ•´å†…å®¹
        'include_images': True,       # å›¾ç‰‡
        'max_results': max_results
    })
    
    return response.json()

# ä½¿ç”¨ç¤ºä¾‹
result = search_with_answer("What is quantum computing?")

# ç›´æ¥è·å–ç­”æ¡ˆ
print("Answer:", result['answer'])

# è·å–è¯¦ç»†æ¥æº
for r in result['results']:
    print(f"- {r['title']}: {r['url']}")
    print(f"  Content: {r['content'][:100]}...")

# è·å–ç›¸å…³å›¾ç‰‡
if result.get('images'):
    print("\nImages:", result['images'][:3])

# è·å–åç»­é—®é¢˜å»ºè®®
if result.get('follow_up_questions'):
    print("\nFollow-up questions:")
    for q in result['follow_up_questions']:
        print(f"  - {q}")
```

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### æœç´¢é€Ÿåº¦æµ‹è¯•

**æµ‹è¯•åœºæ™¯**: æœç´¢ 10 ä¸ªç»“æœï¼ŒåŒ…å«å®Œæ•´å†…å®¹

| é¡¹ç›® | SearCrawl | Perplexica | æ”¹å–„ |
|------|-----------|------------|------|
| å¹³å‡å“åº”æ—¶é—´ | 670 ç§’ | 15-30 ç§’ | **22x æ›´å¿«** |
| å†…å­˜ä½¿ç”¨ | 2-5 Gi | 1-2 Gi | 50% æ›´å°‘ |
| Pod ç¨³å®šæ€§ | æ˜“å´©æºƒ | ç¨³å®š | 100% æ”¹å–„ |
| å›¾ç‰‡æå– | 0% | 95%+ | âˆ æ”¹å–„ |

### èµ„æºä½¿ç”¨å¯¹æ¯”

```yaml
# SearCrawl èµ„æºé…ç½®
resources:
  requests:
    memory: "2Gi"
  limits:
    memory: "5Gi"
# ç»“æœï¼šä»ç„¶ä¸ç¨³å®š

# Perplexica èµ„æºé…ç½®
resources:
  requests:
    memory: "1Gi"
  limits:
    memory: "4Gi"
# ç»“æœï¼šç¨³å®šè¿è¡Œ
```

---

## ğŸ¯ è¿ç§»æ¸…å•

### éƒ¨ç½²å‰

- [ ] å¤‡ä»½ç°æœ‰é…ç½®å’Œæ•°æ®
- [ ] è®°å½• SearCrawl çš„ API ç«¯ç‚¹
- [ ] å‡†å¤‡ API keysï¼ˆOpenAI, Anthropic ç­‰ï¼‰
- [ ] æ£€æŸ¥ AKS é›†ç¾¤èµ„æº

### éƒ¨ç½²ä¸­

- [ ] æ¸…ç† SearCrawl éƒ¨ç½²
- [ ] éƒ¨ç½² Perplexica
- [ ] é…ç½®ç¯å¢ƒå˜é‡/Secrets
- [ ] éªŒè¯ Pod å¥åº·çŠ¶æ€
- [ ] æµ‹è¯• Web UI
- [ ] æµ‹è¯• Tavily API

### éƒ¨ç½²å

- [ ] æ›´æ–°ä¸‹æ¸¸å·¥å…·çš„ API ç«¯ç‚¹
- [ ] è¿ç§»æˆ–é€‚é…ç°æœ‰ä»£ç 
- [ ] è®¾ç½®ç›‘æ§å’Œæ—¥å¿—
- [ ] é…ç½®è‡ªåŠ¨æ‰©å±•ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] å›¢é˜ŸåŸ¹è®­

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. Pod å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹è¯¦æƒ…
kubectl describe pod -l app=perplexica

# å¸¸è§åŸå› ï¼š
# - é•œåƒæ‹‰å–å¤±è´¥ â†’ æ£€æŸ¥ç½‘ç»œ
# - èµ„æºä¸è¶³ â†’ å¢åŠ èŠ‚ç‚¹æˆ–è°ƒæ•´èµ„æºé™åˆ¶
# - PVC æŒ‚è½½å¤±è´¥ â†’ æ£€æŸ¥ StorageClass
```

#### 2. API è¿”å›é”™è¯¯

```bash
# æŸ¥çœ‹æ—¥å¿—
kubectl logs -f -l app=perplexica

# å¸¸è§åŸå› ï¼š
# - ç¼ºå°‘ API key â†’ æ£€æŸ¥ç¯å¢ƒå˜é‡
# - SearxNG æœªé…ç½® â†’ Perplexica è‡ªå¸¦ SearxNG
# - LLM è¿æ¥å¤±è´¥ â†’ éªŒè¯ API key
```

#### 3. æ€§èƒ½æ…¢

```bash
# æ£€æŸ¥èµ„æºä½¿ç”¨
kubectl top pods -l app=perplexica

# ä¼˜åŒ–æ–¹æ¡ˆï¼š
# - å¢åŠ å‰¯æœ¬æ•°
# - ä½¿ç”¨æ›´å¿«çš„ LLM æ¨¡å‹
# - é…ç½®ç¼“å­˜
```

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [Perplexica å®Œæ•´æ–‡æ¡£](./DEPLOYMENT_GUIDE.md)
- [Tavily API å‚è€ƒ](https://docs.tavily.com/)
- [SearCrawl é—®é¢˜æ€»ç»“](../searCrawl-main/FINAL_STATUS_REPORT.md)
- [Kubernetes æœ€ä½³å®è·µ](https://kubernetes.io/docs/concepts/configuration/overview/)

---

## ğŸ‰ è¿ç§»å®Œæˆ

æ­å–œï¼ä½ å·²ç»ä» SearCrawl æˆåŠŸè¿ç§»åˆ° Perplexicaã€‚

**è·å¾—çš„æ”¹è¿›ï¼š**
- âœ… æ›´å¿«çš„æœç´¢é€Ÿåº¦ï¼ˆ22xï¼‰
- âœ… å›¾ç‰‡æœç´¢å’Œæå–
- âœ… è‡ªåŠ¨ç­”æ¡ˆç”Ÿæˆ
- âœ… å®Œæ•´çš„ Web UI
- âœ… æ›´ç¨³å®šçš„æœåŠ¡
- âœ… æ›´å°‘çš„èµ„æºæ¶ˆè€—
- âœ… Tavily å…¼å®¹ API

**ä¸‹ä¸€æ­¥ï¼š**
1. æ¢ç´¢ Web UI çš„å„ç§åŠŸèƒ½
2. å°è¯•ä¸åŒçš„ LLM æ¨¡å‹
3. é›†æˆåˆ°ä½ çš„å·¥ä½œæµç¨‹
4. æ”¶é›†åé¦ˆå’Œä¼˜åŒ–

æœ‰é—®é¢˜ï¼ŸæŸ¥çœ‹ `DEPLOYMENT_GUIDE.md` æˆ–æäº¤ Issueï¼


